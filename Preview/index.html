<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preview</title>
</head>
<body>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap");
@import url('https://fonts.googleapis.com/css2?family=Scheherazade+New:wght@400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Varela+Round&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600&display=swap');
body{

background: #faf7f4;
font-family: "Scheherazade New", serif;

}

iframe {
    width: 98%;
    height: 600px;
    margin-top: 20px;
    border-radius: 25px;
    border: 5px solid #e1d5c4;
}    

video {
    width: 98%;
    height: 600px;
    margin-top: 20px;
    border-radius: 25px;
    border: 5px solid #fff;
}    

img {
    width: 98%;
    height: 600px;
    margin-top: 20px;
    border-radius: 25px;
    border: 5px solid #fff;
}    



</style>

<div id="content-container">
    <!-- Ù…ÙƒØ§Ù† Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
</div>
<script>
    var urlParams = new URLSearchParams(window.location.search);
    var fileUrls = urlParams.get('file'); // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·

    if (fileUrls) {
        var filesArray = fileUrls.split(','); // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… "|"
        filesArray.forEach(displayContent);  // Ø¹Ø±Ø¶ ÙƒÙ„ Ù…Ù„Ù
    }

    function displayContent(fileUrl) {
        var contentContainer = document.getElementById('content-container');
        fileUrl = fileUrl.trim(); // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø§Ù„Ø²Ø§Ø¦Ø¯Ø©

        if (fileUrl.endsWith('.pptx')) {
            var iframe = document.createElement('iframe');
            iframe.src = `https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(fileUrl)}`;
            iframe.width = "100%";
            iframe.height = "600px";
            iframe.frameBorder = "0";
            contentContainer.appendChild(iframe);

        } else if (fileUrl.match(/\.(mp4|webm|ogg)$/)) { // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† ÙÙŠØ¯ÙŠÙˆ
            var video = document.createElement('video');
            video.src = fileUrl;
            video.controls = true;
            contentContainer.appendChild(video);

        } else if (fileUrl.match(/\.(jpg|jpeg|png|gif|svg|webp)$/)) { // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† ØµÙˆØ±Ø©
            var img = document.createElement('img');
            img.src = fileUrl;
            contentContainer.appendChild(img);

        } else {
            var errorMsg = document.createElement('p');
            errorMsg.textContent = "ğŸš« Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­: " + fileUrl;
            contentContainer.appendChild(errorMsg);
        }
    }
</script>

</body>
</html>
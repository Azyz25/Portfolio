<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Abdulazyz Portfolio</title>
  <link rel="icon" type="image/png" href="/assets/img/icon/favicon-32x32.png">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link href="https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css" rel="stylesheet">
</head>
<body>
  <!--===== HEADER =====-->
  <header class="l-header">
    <nav class="nav bd-grid">
      <div class="nav__LOGO">
        <!-- svg blob unchanged -->
      </div>
      <div class="nav__menu" id="nav-menu">
        <ul class="nav__list">
          <li class="nav__item"><a href="#work" class="nav__link">أعمالي</a></li>
          <li class="nav__item"><a href="#skills" class="nav__link">مهاراتي</a></li>
          <li class="nav__item"><a href="#about" class="nav__link">عني</a></li>
          <li class="nav__item"><a href="#home" class="nav__link active-link">الصفحة الرئيسية</a></li>
        </ul>
      </div>
      <div class="nav__toggle" id="nav-toggle"><i class='bx bx-menu'></i></div>
    </nav>
  </header>

  <main class="l-main">
    <!--===== HOME =====-->
    <section class="home bd-grid" id="home">
      <div class="home__data">
        <h1 class="home__title" id="home__title"></h1>
        <div class="title-div"><h4 id="webr"></h4></div>
      </div>
      <div class="home__social">
        <a href="https://wa.me/message/QLJZKXGSEXICD1" class="home__social-icon whatsapp"><i class='bx bxl-whatsapp'></i></a>
        <a href="https://bahr.sa/profile/freelancer/01910dd0-bf98-73df-94cc-08c1fb461d76" class="home__social-icon bahr"><img src="https://bahr.sa/logo/bahr-logo.svg" alt="Bahr" width="37" height="28"></a>
        <a href="https://baaeed.com/u/azyz11223" class="home__social-icon"><img src="https://baaeed.hsoubcdn.com/public/images/logo-icon-colored.png" alt="Baaeed" width="28" height="28"></a>
      </div>
      <div class="home__img">
        <!-- svg blob unchanged -->
      </div>
    </section>

    <!--===== ABOUT =====-->
    <section class="about section" id="about">
      <h2 class="section-title">عنّي</h2>
      <div class="about__container bd-grid">
        <div class="about__img"><img src="/assets/img/perfil.png" alt=""></div>
        <div>
          <h2 class="about__subtitle" id="about__subtitle"></h2>
          <p class="about__text" id="about__text"></p>
        </div>
      </div>
    </section>

    <!--===== SKILLS =====-->
    <section class="skills section" id="skills">
      <h2 class="section-title">مهاراتي</h2>
      <div id="skillsContainer" class="flex items-center justify-between gap-6 rounded-xl bg-beige-0 p-6"></div>
    </section>

    <!--===== WORK =====-->
    <section class="work section" id="work">
      <h2 class="section-title">أعمالي</h2>
      <div class="tabs">
        <button class="tab" data-tab="data-entry">إدخال البيانات<img src="/assets/img/icon/database-management.svg" class="tab-icon"></button>
        <button class="tab" data-tab="external-design">(3D) التصميم الخارجي<img src="/assets/img/icon/vector-alt.svg" class="tab-icon"></button>
        <button class="tab" data-tab="web-development">برمجة الويب<img src="/assets/img/icon/code-window.svg" class="tab-icon"></button>
        <button class="tab" data-tab="branding">تصميم الهويات والشعارات<img src="/assets/img/icon/id-card.svg" class="tab-icon"></button>
        <button class="tab" data-tab="graphic-design">تصميم جرافيك<img src="/assets/img/icon/customize-computer.svg" class="tab-icon"></button>
        <button class="tab" data-tab="Video-Montage">مونتاج فيديو<img src="/assets/img/icon/camera-movie.svg" class="tab-icon"></button>
        <button class="tab" data-tab="UI&UX-design">Ui & UX تصميم<img src="/assets/img/icon/ui-ux.svg" class="tab-icon"></button>
        <button class="tab active" data-tab="powerpoint">عروض الباوربوينت<img src="/assets/img/icon/presentation.svg" class="tab-icon"></button>
      </div>
      <div id="data-entry" class="work__container bd-grid tab-content"></div>
      <div id="external-design" class="work__container bd-grid tab-content"></div>
      <div id="web-development" class="work__container bd-grid tab-content"></div>
      <div id="branding" class="work__container bd-grid tab-content"></div>
      <div id="graphic-design" class="work__container bd-grid tab-content"></div>
      <div id="Video-Montage" class="work__container bd-grid tab-content"></div>
      <div id="UI&UX-design" class="work__container bd-grid tab-content"></div>
      <div id="powerpoint" class="work__container bd-grid tab-content active"></div>
    </section>

    <!--===== CONTACT =====-->
    <section class="contact section" id="contact">
      <div class="contact__container bd-grid">
        <form class="contact__form">
          <input id="text-name" type="text" placeholder="إسمك الكريم" class="contact__input">
          <textarea id="text-message" rows="4" placeholder="رسالتك" class="contact__input"></textarea>
          <input id="button-inp" type="button" value="إرسال" class="contact__button button">
        </form>
      </div>
    </section>
  </main>

  <!--===== FOOTER =====-->
  <footer class="footer">
    <div class="footer__social">
      <a href="#" class="footer__icon"><i class='bx bxl-facebook'></i></a>
      <a href="#" class="footer__icon"><i class='bx bxl-instagram'></i></a>
      <a href="#" class="footer__icon"><i class='bx bxl-twitter'></i></a>
    </div>
    <p class="footer__copy">&#169; عبدالعزيز تكنولوجي , جميع الحقوق محفوظة</p>
  </footer>

  <!--===== FIREBASE & DYNAMIC DATA =====-->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
    import {
      getDatabase, ref, get, onValue, push
    } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-database.js";

    const cfg = {
      apiKey: "AIzaSyCvCUuZPZYU-KvNaALnPC764iTxX5uCKd0",
      authDomain: "newapp-azyz25.firebaseapp.com",
      databaseURL: "https://newapp-azyz25-default-rtdb.firebaseio.com",
      projectId: "newapp-azyz25",
      storageBucket: "newapp-azyz25.appspot.com",
      messagingSenderId: "820384444059",
      appId: "1:820384444059:web:09d81b30b8a14c6603e",
      measurementId: "G-2Y8RBXXDNX"
    };
    const app = initializeApp(cfg);
    const db  = getDatabase(app);

    document.addEventListener("DOMContentLoaded", () => {
      // تسجيل زيارة
      push(ref(db, 'analytics/visits'), { timestamp: Date.now() });

      loadHome();
      loadAbout();
      loadSkills();
      loadWorks();
      activateTabs();
      initAnalytics();
    });

    async function loadHome() {
      const snap = await get(ref(db, 'home'));
      if (!snap.exists()) return;
      const data = snap.val();
      document.getElementById('home__title').innerHTML = data.titleAr;
      document.getElementById('webr').innerText = data.subtitleAr;
    }

    async function loadAbout() {
      const snap = await get(ref(db, 'about'));
      if (!snap.exists()) return;
      const data = snap.val();
      document.getElementById('about__subtitle').innerText = data.titleAr;
      document.getElementById('about__text').innerText     = data.descAr;
    }

    async function loadSkills() {
      const snap = await get(ref(db, 'skills'));
      const container = document.getElementById('skillsContainer');
      container.innerHTML = '';
      if (!snap.exists()) return;
      Object.values(snap.val()).forEach(s => {
        const span = document.createElement('span');
        span.className = "select-none px-2 rounded-full inline-flex justify-center items-center border text-badge py-0.5 gap-2";
        span.style.background = s.bgColor;
        span.style.borderColor = s.borderColor;
        span.innerText = s.nameAr;
        container.appendChild(span);
      });
    }

    async function loadWorks() {
      const snap = await get(ref(db, 'works'));
      if (!snap.exists()) return;
      const data = snap.val();
      Object.entries(data).forEach(([cat, items]) => {
        const container = document.getElementById(cat);
        if (!container) return;
        container.innerHTML = '';
        Object.values(items).forEach(item => {
          const card = document.createElement('div');
          card.className = "work__container bd-grid";
          card.innerHTML = `
            <div class="image-container">
              <img src="${item.imageSrc}" alt="${item.titleAr}">
              <div class="overlay">
                <button class="preview-btn" onclick="openModal(
                  \`${item.titleAr}\`,
                  \`${item.descAr}\`,
                  \`${item.imageSrc}\`,
                  \`${item.previewLink}\`
                )">مـــعــايــنة</button>
              </div>
            </div>`;
          container.appendChild(card);
        });
      });
    }

    function activateTabs() {
      const tabs = document.querySelectorAll(".tab");
      const contents = document.querySelectorAll(".tab-content");
      tabs.forEach(tab => tab.addEventListener("click", () => {
        tabs.forEach(t => t.classList.remove("active"));
        contents.forEach(c => c.classList.remove("active"));
        tab.classList.add("active");
        document.getElementById(tab.dataset.tab)?.classList.add("active");
      }));
      if (!document.querySelector(".tab.active")) tabs[0]?.click();
    }

    function initAnalytics() {
      document.querySelector('.whatsapp').addEventListener('click', () =>
        push(ref(db, 'analytics/whatsapp'), { timestamp: Date.now() })
      );
      document.querySelector('.bahr').addEventListener('click', () =>
        push(ref(db, 'analytics/bahr'), { timestamp: Date.now() })
      );
      document.addEventListener('click', e => {
        if (e.target.classList.contains('preview-btn')) {
          push(ref(db, 'analytics/worksClicks'), { timestamp: Date.now() });
        }
        if (e.target.closest('.tabs button')) {
          push(ref(db, 'analytics/categoriesClicks'), { timestamp: Date.now() });
        }
      });
    }

    function openModal(title, des, imgSrc, link) {
      const m = document.getElementById('modal');
      document.getElementById('modal-title').innerText = title;
      document.getElementById('modal-des').innerText   = des;
      document.getElementById('modal-image').src      = imgSrc;
      document.getElementById('modal-link').href      = link;
      m.classList.add('active');
    }
    function closeModal() {
      document.getElementById('modal').classList.remove('active');
    }
  </script>

  <!-- نافذة المودال -->
  <div id="modal" class="modal">
    <img id="modal-image" src="" alt="">
    <h2 id="modal-title"></h2>
    <button class="close" onclick="closeModal()">&times;</button>
    <p id="modal-des"></p>
    <a id="modal-link" target="_blank">مـــــــعــــايـــــنة</a>
  </div>
</body>
</html>

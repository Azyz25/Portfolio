<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link rel="icon" href="/assets/img/icon/favicon-32x32.png" type="image/png">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link href="https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css" rel="stylesheet">
  <title>بورتفوليو عبدالعزيز</title>
</head>
<body>
  <!-- HEADER ثابت -->
  <header class="l-header">
    <nav class="nav bd-grid">
      <div class="nav__LOGO">
        <!-- SVG logo here -->
      </div>
      <a href="/en/index.html" class="header-text"><span>En</span></a>
      <div class="nav__menu" id="nav-menu">
        <ul class="nav__list" id="nav-categories">
          <li class="nav__item"><a href="#home" class="nav__link active-link">الصفحة الرئيسية</a></li>
          <li class="nav__item"><a href="#about" class="nav__link">عني</a></li>
          <li class="nav__item"><a href="#skills" class="nav__link">مهاراتي</a></li>
          <!-- بقية التصنيفات تُضاف ديناميكياً -->
        </ul>
      </div>
      <div class="nav__toggle" id="nav-toggle"><i class='bx bx-menu'></i></div>
    </nav>
  </header>

  <main class="l-main">
    <!-- HOME ثابت -->
    <section class="home bd-grid" id="home">
      <div class="home__data">
        <h1 class="home__title">هلا<br>أنا <span class="home__title-color">عبدالعزيز</span><br></h1>
        <div class="title-div"><h4 class="home__subtitle">( مطور مواقع )</h4></div>
      </div>
      <div class="home__social">
        <a href="https://wa.me/message/QLJZKXGSEXICD1" class="home__social-icon"><i class='bx bxl-whatsapp'></i></a>
        <a href="https://bahr.sa/profile/freelancer/01910dd0-bf98-73df-94cc-08c1fb461d76" class="home__social-icon">
          <img src="https://bahr.sa/logo/bahr-logo.svg" alt="Bahr" width="28" height="28">
        </a>
        <a href="https://baaeed.com/u/azyz11223" class="home__social-icon" target="_blank">
          <img src="https://baaeed.hsoubcdn.com/public/images/logo-icon-colored.png" alt="Hsoub" width="28" height="28">
        </a>
      </div>
      <div class="home__img">
        <!-- SVG blob + صورة البروفايل -->
      </div>
    </section>

    <!-- ABOUT ديناميكي -->
    <section class="about section" id="about">
      <div class="cont-h2"><h2 class="section-title">عنّي</h2></div>
      <div class="about__container bd-grid">
        <div class="about__img"><img src="/assets/img/perfil.png" alt="profile"></div>
        <div>
          <h2 class="about__subtitle" id="about-title">أنا عبدالعزيز</h2>
          <p class="about__text" id="about-desc">جاري التحميل…</p>
        </div>
      </div>
    </section>

    <!-- SKILLS ثابت -->
    <section class="skills section" id="skills">
      <div class="cont-h2"><h2 class="section-title">مهاراتي</h2></div>
      <div class="skills__list">
        <!-- القوائم الثابتة تحافظ كما هي -->
      </div>
    </section>

    <!-- WORK ديناميكي -->
    <section class="work section" id="work">
      <div class="cont-h2"><h2 class="section-title">أعمالي</h2></div>
      <div class="tabs" id="work-tabs">
        <!-- أزرار الفئات تُنشأ ديناميكياً -->
      </div>
      <div id="work-contents">
        <!-- محتوى كل فئة يُنشأ ديناميكياً -->
      </div>
    </section>

    <!-- CONTACT ثابت -->
    <section class="contact section" id="contact">
      <div class="contact__container bd-grid">
        <form class="contact__form">
          <input id="text-name" type="text" placeholder="إسمك الكريم" class="contact__input">
          <textarea id="text-message" rows="4" class="contact__input"></textarea>
          <div class="but-cnt">
            <input id="button-inp" type="button" value="إرسال" class="contact__button button">
          </div>
        </form>
      </div>
    </section>
  </main>

  <!-- FOOTER ثابت -->
  <footer class="footer">
    <div class="FOOTER-LOGO">
      <!-- نفس الشعار -->
    </div>
    <div class="footer__social">
      <a href="#"><i class='bx bxl-facebook'></i></a>
      <a href="#"><i class='bx bxl-instagram'></i></a>
      <a href="#"><i class='bx bxl-twitter'></i></a>
    </div>
    <p class="footer__copy">&#169; عبدالعزيز تكنولوجي، جميع الحقوق محفوظة</p>
  </footer>

  <!-- MODAL Preview -->
  <div id="modal" class="modal">
    <img id="modal-image" src="" alt="">
    <h2 id="modal-title"></h2>
    <button class="close" onclick="closeModal()">&times;</button>
    <h2 id="modal-des"></h2>
    <a id="modal-link" href="" target="_blank">مـــــــعــــايـــــنة</a>
  </div>

  <script src="https://unpkg.com/scrollreveal"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-database.js";

    const cfg = {
      apiKey: "AIzaSyCvCUuZPZYU-KvNaALnPC764iTxX5uCKd0",
      authDomain: "newapp-azyz25.firebaseapp.com",
      databaseURL: "https://newapp-azyz25-default-rtdb.firebaseio.com",
      projectId: "newapp-azyz25",
      storageBucket: "newapp-azyz25.appspot.com",
      messagingSenderId: "820384444059",
      appId: "1:820384444059:web:09d81b30b8a14c6603e",
      measurementId: "G-2Y8RBXXDNX"
    };
    const app = initializeApp(cfg);
    const db  = getDatabase(app);

    // تحميل About
    get(ref(db,'about')).then(snap=>{
      const d = snap.val()||{};
      document.getElementById('about-title').textContent = d.title || 'أنا عبدالعزيز';
      document.getElementById('about-desc' ).textContent = d.desc  || '';
    });

    // تحميل الأعمال والفئات
    get(ref(db,'works')).then(snap=>{
      const data = snap.val()||{};
      const navC = document.getElementById('nav-categories');
      const tabsC= document.getElementById('work-tabs');
      const contC= document.getElementById('work-contents');

      Object.entries(data).forEach(([key,cat], i)=>{
        // أضف nav
        const li = document.createElement('li');
        li.className = 'nav__item';
        li.innerHTML = `<a href="#${key}" class="nav__link">${cat.nameAr||key}</a>`;
        navC.appendChild(li);

        // زر تبويب
        const btn = document.createElement('button');
        btn.className = 'tab' + (i===0?' active':'');
        btn.dataset.tab = key;
        btn.textContent = cat.nameAr||key;
        tabsC.appendChild(btn);

        // حاوية محتوى
        const div = document.createElement('div');
        div.id = key;
        div.className = 'work__container bd-grid tab-content' + (i===0?' active':'');
        (cat instanceof Array ? cat : cat.items||[]).forEach(item=>{
          const c = document.createElement('div');
          c.className = 'image-container';
          c.innerHTML = `
            <img src="${item.imageSrc}" alt="${item.alt||item.title}">
            <div class="overlay">
              <button onclick="openModal(
                \`${item.title}\`,
                \`${item.description}\`,
                \`${item.imageSrc}\`,
                \`${item.previewLink}\`
              )">مــــــعــــايـــــنة</button>
            </div>`;
          div.appendChild(c);
        });
        if (!div.hasChildNodes()) {
          div.innerHTML = '<p class="empty-message">لا توجد أعمال مرفوعة لهذه الفئة</p>';
        }
        contC.appendChild(div);
      });

      // تبديل التبويبات
      tabsC.querySelectorAll('.tab').forEach(btn=>{
        btn.addEventListener('click',()=>{
          tabsC.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
          contC.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
          btn.classList.add('active');
          document.getElementById(btn.dataset.tab).classList.add('active');
        });
      });
    });

    function openModal(title, desc, img, link){
      document.getElementById('modal-title').innerText = title;
      document.getElementById('modal-des'  ).innerText = desc;
      document.getElementById('modal-image').src       = img;
      document.getElementById('modal-link' ).href      = link;
      document.getElementById('modal').classList.add('active');
    }
    function closeModal(){
      document.getElementById('modal').classList.remove('active');
    }
  </script>
</body>
</html>